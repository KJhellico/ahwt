# AHWT - очередная утилита для харденинга Windows.
![image](https://github.com/n0rthl1ght/ahwt/assets/92512883/baaa0517-bae0-4869-a50e-e1556b084ed5)

## Описание
Программа является генератором скриптов с коллекцией параметров и рекомендаций из бенчмарков CIS и STIGов от DoD с некоторыми доработками.

Все параметры размещены в БД с именами операционных систем, которые содержат параметры для соответствующих систем.

Параметры были вручную проверены и протестированы в соответствии с официальной документацией от Майкрософт и мнениями известных специалистов.

Скрипты генерируются в двух режимах - автоматическом и ручном.

Все БД имеют профили min/med/full, где min - Minimum (только параметры уровня 3 (уровень 2 CIS/уровень 3 STIG)), med - Medium (параметры уровней 2 и 3 (уровени 1 и 2 CIS/уровень 2 STIG)) и Full (все параметры, уровень 1-3).

![image](https://github.com/n0rthl1ght/ahwt/assets/92512883/406eca52-b9d1-44e3-854b-f1e24e037ee6)

Для каждой ОС были созданы дополнительные профили, которые можно сгенерировать отдельно либо после генерации основного скрипта:
1. Windows XP
   - Windows Firewall (Режим ShieldUp имеет отдельное подтверждение)
   - Internet Explorer (версии 6-8)
2. Windows Vista
   - Windows Firewall (Режим ShieldUp имеет отдельное подтверждение)
   - Windows Defender
   - Internet Explorer (версии 7-9)
3. Windows 7
   - Windows Firewall (Режим ShieldUp имеет отдельное подтверждение)
   - Windows Defender
   - BitLocker
   - Internet Explorer (версии 8-11)
4. Windows 8
   - Windows Firewall (Режим ShieldUp имеет отдельное подтверждение)
   - Windows Defender
   - BitLocker
   - Internet Explorer (версии 10-11)
5. Windows 8.1
   - Windows Firewall (Режим ShieldUp имеет отдельное подтверждение)
   - Windows Defender
   - BitLocker
   - Internet Explorer (версия 11)
6. Windows 10
   - Windows Firewall (Режим ShieldUp имеет отдельное подтверждение)
   - Windows Defender
   - BitLocker
   - MS Edge
   - Next Generation Security
   - Internet Explorer (версия 11)
7. Windows 11
   - Windows Firewall (Режим ShieldUp имеет отдельное подтверждение)
   - Windows Defender
   - BitLocker
   - MS Edge
   - Next Generation Security
8. MS Office
   - MS Office 2003
   - MS Office 2007
   - MS Office 2010
   - MS Office 2013
   - MS Office 2016 (включая 2019 & 2021)
   - MS Office 365

> [!WARNING]
> Режим ShieldUp блокирует все входящие соединения, включая исключения, которые находятся в разрешенных в настройках Windows или Панели управления

В ручном режиме вы можете проверить каждый параметр с полным описанием его назначения. Описание будет переведено (спасибо Google Translate) на системный язык при наличии интернет-соединения.

![image](https://github.com/n0rthl1ght/ahwt/assets/92512883/f7be2112-60d7-44e7-b597-bb5cb690455e)

## Под капотом

Каждый сгенерированный скрипт имеет команду для создания точки восстановления (если сервис отключен, скрипт включит его (исключая аддоны, там только создание точки)).

Применяемые параметры содержат шаблон secedit и sdb файл к нему, параметры auditpol, отключение некоторых сервисов через PS и параметры реестра из БД. 
Все скрипты в виде ```.bat``` файлов. Не люблю синтаксис PS :)

Все дополнительные файлы, как шаблон secedit, находятся в папке Templates.

> [!NOTE]
> Для использования параметров EMET для Windows 7-8.1 вам необходимо установить EMET 5.52 (в релизе лежит в папке Templates)
> Параметры для 2016 версии подходят к 2019 и 2021, т.к. используют один ADMX файл для настройки политик. Если у вас 2019 или 2021 версия, используйте параметры харденинга для 2016 версии.

## Использование

1. Скачать
2. Запустить ```python AHWT.py```
3. Выбрать ОС
   
   ![image](https://github.com/n0rthl1ght/ahwt/assets/92512883/9944050a-6efb-4bb1-a845-eed1859c4604)

4. Ввести имя скрипта

   ![image](https://github.com/n0rthl1ght/ahwt/assets/92512883/6ef6f64f-d7ff-4c9c-a802-3e988e1ac7ec)

5. Выбрать режим
   
   ![image](https://github.com/n0rthl1ght/ahwt/assets/92512883/51373b37-c385-40e5-adea-a66be9443935)

6. Выбрать профиль харденинга

   ![image](https://github.com/n0rthl1ght/ahwt/assets/92512883/cf7d3cea-a8e2-4c85-8962-d7ff3fc8209d)

7. По желанию добавить дополнительные параметры

   ![image](https://github.com/n0rthl1ght/ahwt/assets/92512883/429dd5a9-2388-4d16-a4e6-fc35f71a50e6)

8. Скопировать необходимые файлы из папки Templates и поместить их рядом со скриптом

    ![image](https://github.com/n0rthl1ght/ahwt/assets/92512883/531edd63-58b0-489f-9a87-12ed33c08e81) -> ![image](https://github.com/n0rthl1ght/ahwt/assets/92512883/3cbdaf57-74c3-4236-9abf-cb9feaf837f1) -> ![image](https://github.com/n0rthl1ght/ahwt/assets/92512883/b1c0e6dc-6942-4bc4-b779-1988c6824f16)

9. Запустить скрипт на целевой машине

> [!CAUTION]
> Перед применением на реальной машине обязательно тестируйте на тестовом ПК или ВМ

### Оставляйте фидбэк, без него дальше никак ;)

## Roadmap
- [ ] Обогатить БД новыми параметрами для каждой ОС
- [ ] Оптимизировать код (да, сейчас это говнокод)
- [ ] Добавить поддержку сторонних приложений, серверных версий ОС и всего, что так или иначе может быть полезно и связано с Windows
- [ ] Что нибудь еще...

Сделано с желанием помочь сотрудникам ИБ ❤️
